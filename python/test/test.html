<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>WebSocket 测试</title>
</head>
<body>
  <h3>WebSocket 流式测试</h3>
  <pre id="log"></pre>
  <script>
    let log = document.getElementById("log");

    function append(msg) {
      log.textContent += msg + "\n";
    }

    // let socket = new WebSocket("wss://frp-gap.com:16943/ws/chat");
    // let socket = new WebSocket("wss://119.84.246.218:16943/ws/chat");
    // let socket = new WebSocket("https://frp-gap.com:16943/ws/chat");
    let socket = new WebSocket("http://127.0.0.1:8000/sse/chat");

    socket.onopen = () => {
      append("✅ 连接成功");
      socket.send("你好，这是 HTML 页面测试");
    };

    socket.onmessage = (event) => {
      append("📩 " + event.data);
      if (event.data === "[END]") {
        append("✅ 消息流结束");
        socket.close();
      }
    };

    socket.onerror = (err) => append("❌ 出错: " + err);
    socket.onclose = () => append("🔌 连接关闭");
  </script>
</body>
</html>
