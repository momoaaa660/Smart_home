<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>WebSocket æµ‹è¯•</title>
</head>
<body>
  <h3>WebSocket æµå¼æµ‹è¯•</h3>
  <pre id="log"></pre>
  <script>
    let log = document.getElementById("log");

    function append(msg) {
      log.textContent += msg + "\n";
    }

    // let socket = new WebSocket("wss://frp-gap.com:16943/ws/chat");
    // let socket = new WebSocket("wss://119.84.246.218:16943/ws/chat");
    // let socket = new WebSocket("https://frp-gap.com:16943/ws/chat");
    let socket = new WebSocket("http://127.0.0.1:8000/sse/chat");

    socket.onopen = () => {
      append("âœ… è¿æ¥æˆåŠŸ");
      socket.send("ä½ å¥½ï¼Œè¿™æ˜¯ HTML é¡µé¢æµ‹è¯•");
    };

    socket.onmessage = (event) => {
      append("ğŸ“© " + event.data);
      if (event.data === "[END]") {
        append("âœ… æ¶ˆæ¯æµç»“æŸ");
        socket.close();
      }
    };

    socket.onerror = (err) => append("âŒ å‡ºé”™: " + err);
    socket.onclose = () => append("ğŸ”Œ è¿æ¥å…³é—­");
  </script>
</body>
</html>
